<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì£¼ë¬¸ ë° ì£¼ë¬¸ í•­ëª© ë“±ë¡</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f4f4; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        h1 { text-align: center; color: #333; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input[type="text"], input[type="number"], textarea, select, input[type="datetime-local"] { width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .form-row { margin-bottom: 15px; }
        .order-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; background-color: #fafafa; border-radius: 4px; }
        .order-item h4 { margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .delete-row { float: right; color: red; cursor: pointer; border: none; background: none; font-size: 16px; }
        .add-row { background-color: #5cb85c; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; }
        .submit-btn { background-color: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-size: 1.1em; margin-top: 20px; }
        .errorlist { color: red; list-style-type: none; padding: 0; margin: 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ½ï¸ ë„ì‹œë½ ì£¼ë¬¸í•˜ê¸°</h1>

        {% if form.errors or formset.errors %}
            <div style="color: red; padding: 10px; border: 1px solid red;">
                <h4>ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜ ë°œìƒ!</h4>
                <p>ì…ë ¥ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                {% if form.errors %}
                    <h5>ì£¼ë¬¸ ì •ë³´ ì˜¤ë¥˜:</h5>
                    {{ form.errors }}
                {% endif %}
                {% if formset.errors %}
                    <h5>ì£¼ë¬¸ í•­ëª© ì˜¤ë¥˜:</h5>
                    {% endif %}
            </div>
        {% endif %}

        <form method="post">
            {% csrf_token %}

            <h2>1. ì£¼ë¬¸ì ì •ë³´ ë° ì˜µì…˜</h2>

            <div class="form-row">
                {{ form.pickup_date_time.label_tag }}
                {{ form.pickup_date_time }}
                {% if form.pickup_date_time.errors %}
                    <ul class="errorlist">
                        {% for error in form.pickup_date_time.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>

            <div class="form-row">
                <label>
                    {{ form.is_delivery }} ë°°ë‹¬ë¡œ ì£¼ë¬¸í•©ë‹ˆë‹¤.
                </label>
            </div>

            <div class="form-row">
                {{ form.delivery_address.label_tag }}
                {{ form.delivery_address }}
                {% if form.delivery_address.errors %}
                    <ul class="errorlist">
                        {% for error in form.delivery_address.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>

            {% if is_edit %}
                <h2>ğŸ›’ ì£¼ë¬¸í•œ ë„ì‹œë½ ëª©ë¡</h2>
            {% else %}
                <h2>ğŸ›’ ì¥ë°”êµ¬ë‹ˆ ëª©ë¡</h2>
            {% endif %}
                <table style="width:100%; border-collapse: collapse; margin-bottom: 20px;">
                    <thead>
                      <tr style="background-color: #eee;">
                        <th style="border: 1px solid #ccc; padding: 8px;">ì´ë¦„</th>
                        <th style="border: 1px solid #ccc; padding: 8px;">ê°€ê²©</th>
                        <th style="border: 1px solid #ccc; padding: 8px;">í• ì¸ ê°€ê²©</th>
                        <th style="border: 1px solid #ccc; padding: 8px;">ì¹´í…Œê³ ë¦¬</th>
                        <th style="border: 1px solid #ccc; padding: 8px;">ìˆ˜ëŸ‰</th>
                      </tr>
                  </thead>
                  <tbody>
                      {% for item in queryset %}
                      <tr>
                          <td style="border: 1px solid #ccc; padding: 8px;">
                              <strong>{{ item.lunchbox.name }}</strong>
                          </td>
                          <td style="border: 1px solid #ccc; padding: 8px;">{{ item.lunchbox.price|default:"-" }}ì›</td>
                          <td style="border: 1px solid #ccc; padding: 8px; color: red;">
                              {{ item.lunchbox.discount_price|default:"-" }}ì›
                          </td>
                          <td style="border: 1px solid #ccc; padding: 8px;">{{ item.lunchbox.food_category }}</td>
                          <td style="border: 1px solid #ccc; padding: 8px;">{{ item.quantity }}ê°œ</td>
                      </tr>
                      {% empty %}
                      <tr>
                          <td colspan="6" style="text-align: center; padding: 10px;">í˜„ì¬ ì¥ë°”êµ¬ë‹ˆì— ë„ì‹œë½ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                      </tr>
                      {% endfor %}
                  </tbody>
              </table>

            <button type="submit" class="submit-btn">
                {% if is_edit %}
                    ì£¼ë¬¸ ìˆ˜ì •
                {% else %}
                    ì£¼ë¬¸ ì™„ë£Œ ë° ê²°ì œ
                {% endif %}
            </button>
        </form>
    </div>
</body>
</html>